{% extends 'base.html' %}

{% block title %}Заказ №{{ order.id }} {% endblock title %}


{% block content %}
    <div class="container mt-3">
        <p><strong>Заказ № {{ order.id }} Cтатус: {{ order.get_status_display }}</strong></p>
        <p><strong>Дата и время:</strong> {{ order.work_start }}, {{ order.work_start |date:'l'}}</p>
        <p><strong>Адресс:</strong> {{ order.address | capfirst }}</p>
        <p><strong>Тип объекта:</strong> {{ order.object_type | capfirst }}</p>
        {% if extra_service %}
            <p><strong>Услуги Заказа:</strong></p>
            {% for extra in extra_service %}
                <ul>
                    <li>
                        <p>{{ extra | capfirst }}
                            <a href="{% url 'crmapp:service_order_update' extra.id %}"><i
                                    class="fa-solid fa-pen-to-square"></i></a>
                            <a class="text-danger" href="{% url 'crmapp:service_order_delete' extra.id %}"><i
                                    class="fa-solid fa-xmark"></i></a>
                        </p>
                    </li>
                </ul>
            {% endfor %}
        {% endif %}
        <p><a class="btn btn-primary" href="{% url 'crmapp:service_order_create' order.id %}">+Добавить
            услугу</a></p>
        <span><strong>Клинеры на объекте:</strong></span>
        {% for cleaner in staff %}
            <ul>
                <li>
                    <a style="text-decoration: none"
                       href="{% url 'accounts:profile' cleaner.id %}"> {{ cleaner.staff.first_name }} {{ cleaner.staff.last_name }} </a>
                    <a class="text-danger" href="{% url 'crmapp:order_staff_delete' cleaner.id %}"><i
                            class="fa-solid fa-xmark"></i></a>
                </li>
            </ul>
        {% endfor %}
        <p><a class="btn btn-primary" href="{% url 'crmapp:order_staff_add' order.id %}">+Добавить
            клинера</a></p>
        <span><strong>Инвентарь:</strong></span>
        {% for inventory in order.order_inventories.all %}
            <ul>
                <li>
                    <p>{{ inventory.inventory.name }}: {{ inventory.amount }}
                    <a class="text-danger" href="{% url 'crmapp:inventory_order_remove' inventory.pk %}"><i
                                    class="fa-solid fa-xmark"></i></a>
                    </p>

                </li>
            </ul>
        {% endfor %}
        <p><a class="btn btn-primary" href="{% url 'crmapp:inventory_order_add' order.id %}">+Добавить/Изменить инвентарь</a></p>
        <p><strong>Общее время работы:</strong> {{ order.cleaning_time }} ч.</p>
        <p><strong>Заказ будет будет выполнен в:</strong> {{ order.work_end }}</p>
        <p><strong>Вид оплаты: </strong>{{ order.get_payment_type_display }}</p>
        <h5><strong>Общая стоимость: {{ order.get_total }} с </strong></h5>
        <hr>
        <p>Менеджер: {{ order.manager.first_name }} {{ order.manager.last_name }}</p>
        <small class="text-muted">Заказ создан: {{ order.created_at }}</small>
        <p><a class="btn btn-dark" href="{% url 'crmapp:manager_report_create' order.id %}">Рассчитать ЗП</a></p>
    </div>

{% endblock content %}